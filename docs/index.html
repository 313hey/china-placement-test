<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>来华研学插班中文分级测评</title>
  <style>
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Microsoft YaHei",Arial,sans-serif;max-width:960px;margin:24px auto;padding:0 16px;}
    .muted{color:#666;font-size:14px;line-height:1.6}
    .card{border:1px solid #ddd;border-radius:14px;padding:16px;margin:12px 0;background:#fff;}
    .row{display:flex;gap:12px;flex-wrap:wrap;}
    input,select{padding:10px;border:1px solid #ccc;border-radius:10px;min-width:260px;background:#fff;}
    .btn{padding:12px 16px;border-radius:10px;border:1px solid #ddd;background:#fff;cursor:pointer}
    .btnPrimary{background:#111;color:#fff;border-color:#111}
    .btn:disabled{opacity:.5;cursor:not-allowed}
  </style>
</head>

<body>
  <h1>来华研学插班中文分级测评（在线）</h1>
  <p class="muted">请先填写信息，点击开始后进入考试页面。题库对所有项目通用。</p>

  <div class="card">
    <div class="row">
      <div>
        <div class="muted">姓名 Name</div>
        <input id="name" placeholder="例如：Alex" autocomplete="name"/>
      </div>

      <div>
        <div class="muted">学校/项目 School</div>
        <select id="schoolSelect"></select>
      </div>
    </div>

    <div style="margin-top:14px;">
      <button id="startBtn" class="btn btnPrimary" disabled>开始考试</button>
      <span id="tip" class="muted" style="margin-left:10px;"></span>
    </div>
  </div>

  <script src="./questions.js"></script>
  <script>
    const nameEl = document.getElementById("name");
    const sel = document.getElementById("schoolSelect");
    const btn = document.getElementById("startBtn");
    const tip = document.getElementById("tip");

    // 下拉选项来自 questions.js 里的 PROJECT_OPTIONS（你后期随便改）
    sel.innerHTML =
      '<option value="" disabled selected>请选择…</option>' +
      (Array.isArray(window.PROJECT_OPTIONS) ? window.PROJECT_OPTIONS : []).map(o =>
        `<option value="${o.value}">${o.label}</option>`
      ).join("");

    function update() {
      const ok = nameEl.value.trim() && sel.value;
      btn.disabled = !ok;
      tip.textContent = ok ? "" : "请填写姓名并选择项目";
    }
    nameEl.addEventListener("input", update);
    sel.addEventListener("change", update);

    btn.addEventListener("click", () => {
      localStorage.setItem("quiz_name", nameEl.value.trim());
      localStorage.setItem("quiz_school", sel.value);

      // 清理上次答案
      localStorage.removeItem("quiz_answers");
      localStorage.removeItem("quiz_result");
      localStorage.setItem("quiz_section", "listening"); // 从听力开始

      // 同目录跳转（别写 index.html/exam.html 这种）
      location.href = "./exam.html";
    });

    update();
  </script>
</body>
</html>
